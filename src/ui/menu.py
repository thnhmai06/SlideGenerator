# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'ui\menu.ui'
#
# Created by: PyQt5 UI code generator 5.15.11
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui
from PyQt5.QtWidgets import *
from src.event import brosweEvent, tableEvent, listEvent
from src.script import process
from src.ui import progress

class Ui(QMainWindow):
    def __init__(self,):
        super().__init__()
        self.setupUi()
        self.retranslateUi()
        self.handleUI()

        # Init progress window
        self.progress = None 
    def setupUi(self):
        self.setObjectName("menu")
        self.resize(959, 867)
        self.setMinimumSize(QtCore.QSize(959, 867))
        self.setMaximumSize(QtCore.QSize(959, 867))
        self.setCursor(QtGui.QCursor(QtCore.Qt.ArrowCursor))
        self.setMouseTracking(False)
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(":/main/uet"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.setWindowIcon(icon)
        self.setWhatsThis("")
        self.setAutoFillBackground(False)
        self.centralwidget = QWidget(self)
        self.centralwidget.setObjectName("centralwidget")
        self.title = QLabel(self.centralwidget)
        self.title.setEnabled(True)
        self.title.setGeometry(QtCore.QRect(190, 20, 611, 81))
        font = QtGui.QFont()
        font.setFamily("Segoe UI")
        font.setPointSize(26)
        font.setBold(True)
        font.setWeight(75)
        self.title.setFont(font)
        self.title.setMouseTracking(False)
        self.title.setTextFormat(QtCore.Qt.AutoText)
        self.title.setScaledContents(False)
        self.title.setWordWrap(False)
        self.title.setObjectName("title")
        self.template = QGroupBox(self.centralwidget)
        self.template.setGeometry(QtCore.QRect(20, 120, 411, 161))
        self.template.setObjectName("template")
        self.template_broswe = QPushButton(self.template)
        self.template_broswe.setGeometry(QtCore.QRect(300, 90, 93, 28))
        self.template_broswe.setObjectName("template_broswe")
        self.template_path = QLineEdit(self.template)
        self.template_path.setGeometry(QtCore.QRect(20, 90, 271, 31))
        self.template_path.setCursorPosition(0)
        self.template_path.setDragEnabled(False)
        self.template_path.setObjectName("template_path")
        self.template_label = QLabel(self.template)
        self.template_label.setGeometry(QtCore.QRect(20, 40, 171, 31))
        self.template_label.setObjectName("template_label")
        self.dssv = QGroupBox(self.centralwidget)
        self.dssv.setGeometry(QtCore.QRect(510, 120, 411, 161))
        self.dssv.setObjectName("dssv")
        self.dssv_broswe = QPushButton(self.dssv)
        self.dssv_broswe.setGeometry(QtCore.QRect(300, 90, 93, 28))
        self.dssv_broswe.setObjectName("dssv_broswe")
        self.dssv_path = QLineEdit(self.dssv)
        self.dssv_path.setGeometry(QtCore.QRect(20, 90, 271, 31))
        self.dssv_path.setCursorPosition(0)
        self.dssv_path.setDragEnabled(False)
        self.dssv_path.setObjectName("dssv_path")
        self.dssv_label = QLabel(self.dssv)
        self.dssv_label.setGeometry(QtCore.QRect(20, 40, 221, 31))
        self.dssv_label.setObjectName("dssv_label")
        self.VTLuu = QGroupBox(self.centralwidget)
        self.VTLuu.setGeometry(QtCore.QRect(20, 720, 411, 121))
        self.VTLuu.setObjectName("VTLuu")
        self.VTLuu_broswe = QPushButton(self.VTLuu)
        self.VTLuu_broswe.setGeometry(QtCore.QRect(300, 60, 93, 28))
        self.VTLuu_broswe.setObjectName("VTLuu_broswe")
        self.VTLuu_path = QLineEdit(self.VTLuu)
        self.VTLuu_path.setGeometry(QtCore.QRect(20, 60, 271, 31))
        self.VTLuu_path.setCursorPosition(0)
        self.VTLuu_path.setDragEnabled(False)
        self.VTLuu_path.setObjectName("VTLuu_path")
        self.VTLuu_label = QLabel(self.VTLuu)
        self.VTLuu_label.setGeometry(QtCore.QRect(20, 20, 81, 31))
        self.VTLuu_label.setObjectName("VTLuu_label")
        self.start_button = QPushButton(self.centralwidget)
        self.start_button.setGeometry(QtCore.QRect(690, 740, 191, 71))
        self.start_button.setObjectName("start_button")
        self.uet = QLabel(self.centralwidget)
        self.uet.setGeometry(QtCore.QRect(30, 20, 81, 81))
        self.uet.setObjectName("uet")
        self.github = QLabel(self.centralwidget)
        self.github.setGeometry(QtCore.QRect(870, 10, 31, 31))
        self.github.setObjectName("github")
        self.github.setOpenExternalLinks(True)
        self.config = QGroupBox(self.centralwidget)
        self.config.setGeometry(QtCore.QRect(20, 300, 901, 401))
        self.config.setObjectName("config")
        self.config_image_table = QTableWidget(self.config)
        self.config_image_table.setGeometry(QtCore.QRect(470, 60, 401, 301))
        self.config_image_table.setObjectName("config_image_table")
        self.config_image_table.setColumnCount(2)
        self.config_image_table.setRowCount(0)
        item = QTableWidgetItem()
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.config_image_table.setHorizontalHeaderItem(0, item)
        item = QTableWidgetItem()
        font = QtGui.QFont()
        font.setBold(True)
        font.setWeight(75)
        item.setFont(font)
        self.config_image_table.setHorizontalHeaderItem(1, item)
        self.config_image_table.horizontalHeader().setHighlightSections(True)
        self.config_image_table.horizontalHeader().setSortIndicatorShown(False)
        self.config_image_table.horizontalHeader().setStretchLastSection(True)
        self.config_image_table.verticalHeader().setVisible(True)
        self.config_image_table.horizontalHeader().setSectionResizeMode(QHeaderView.Fixed) #Khóa không cho thay đổi kích thước Section nữa :D
        self.config_text_label = QLabel(self.config)
        self.config_text_label.setGeometry(QtCore.QRect(20, 30, 401, 20))
        self.config_text_label.setObjectName("config_text_label")
        self.config_image_label = QLabel(self.config)
        self.config_image_label.setGeometry(QtCore.QRect(470, 30, 401, 20))
        self.config_image_label.setObjectName("config_image_label")
        self.config_image_autodownload_label = QLabel(self.config)
        self.config_image_autodownload_label.setGeometry(QtCore.QRect(470, 370, 211, 16))
        self.config_image_autodownload_label.setObjectName("config_image_autodownload_label")
        self.config_image_add_button = QPushButton(self.config)
        self.config_image_add_button.setGeometry(QtCore.QRect(800, 370, 31, 21))
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap(":/main/add"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.config_image_add_button.setIcon(icon1)
        self.config_image_add_button.setObjectName("config_image_add_button")
        self.config_image_remove_button = QPushButton(self.config)
        self.config_image_remove_button.setGeometry(QtCore.QRect(840, 370, 31, 21))
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap(":/main/remove"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.config_image_remove_button.setIcon(icon2)
        self.config_image_remove_button.setObjectName("config_image_remove_button")
        self.config_text_remove_button = QPushButton(self.config)
        self.config_text_remove_button.setGeometry(QtCore.QRect(390, 370, 31, 21))
        self.config_text_remove_button.setIcon(icon2)
        self.config_text_remove_button.setObjectName("config_text_remove_button")
        self.config_text_add_button = QPushButton(self.config)
        self.config_text_add_button.setGeometry(QtCore.QRect(350, 370, 31, 21))
        self.config_text_add_button.setIcon(icon1)
        self.config_text_add_button.setObjectName("config_text_add_button")
        self.config_text_list = QListWidget(self.config)
        self.config_text_list.setGeometry(QtCore.QRect(20, 60, 401, 301))
        self.config_text_list.setObjectName("config_text_list")
        item = QListWidgetItem()
        item.setFlags(item.flags() | QtCore.Qt.ItemIsEditable)
        self.config_text_list.addItem(item)
        item = QListWidgetItem()
        item.setFlags(item.flags() | QtCore.Qt.ItemIsEditable)
        self.config_text_list.addItem(item)
        item = QListWidgetItem()
        item.setFlags(item.flags() | QtCore.Qt.ItemIsEditable)
        self.config_text_list.addItem(item)
        self.about = QLabel(self.centralwidget)
        self.about.setGeometry(QtCore.QRect(930, 10, 31, 31))
        self.about.setObjectName("about")
        self.guide = QLabel(self.centralwidget)
        self.guide.setGeometry(QtCore.QRect(900, 10, 21, 31))
        self.guide.setObjectName("guide")
        self.setCentralWidget(self.centralwidget)
        self.statusbar = QStatusBar(self)
        self.statusbar.setObjectName("statusbar")
        self.setStatusBar(self.statusbar)

        QtCore.QMetaObject.connectSlotsByName(self)
    def retranslateUi(self):
        github_link = "https://github.com/thnhmai06/tao-slide-tot-nghiep"

        _translate = QtCore.QCoreApplication.translate
        self.setWindowTitle(_translate("menu", "Phần mềm tạo slide tốt nghiệp"))
        self.title.setText(_translate("menu", "PHẦN MỀM TẠO SLIDE TỐT NGHIỆP"))
        self.template.setTitle(_translate("menu", "B1. Chọn mẫu"))
        self.template_broswe.setText(_translate("menu", "Duyệt"))
        self.template_label.setText(_translate("menu", "<html><head/><body><p><span style=\" font-weight:600;\">Chọn file Template </span>(.pptx)</p></body></html>"))
        self.dssv.setTitle(_translate("menu", "B2. Chọn danh sách sinh viên"))
        self.dssv_broswe.setText(_translate("menu", "Duyệt"))
        self.dssv_label.setText(_translate("menu", "<html><head/><body><p><span style=\" font-weight:600;\">Chọn danh sách sinh viên </span>(.csv)</p></body></html>"))
        self.VTLuu.setTitle(_translate("menu", "B4. Chọn vị trí lưu"))
        self.VTLuu_broswe.setText(_translate("menu", "Duyệt"))
        self.VTLuu_label.setText(_translate("menu", "<html><head/><body><p><span style=\" font-weight:600;\">Chọn vị trí lưu</span></p></body></html>"))
        self.start_button.setText(_translate("menu", "Bắt đầu"))
        self.uet.setText(_translate("menu", "<html><head/><body><p><img src=\":/main/uet\"/></p></body></html>"))
        self.uet.setToolTip("CTSV.UET.VNU")
        self.github.setText(_translate("menu", f'<html><head/><body><p><a href="{github_link}"><img src=\":/main/github\"/></a></p></body></html>'))
        self.github.setToolTip("Github")
        self.config.setTitle(_translate("menu", "B3. Thiết lập thay thế"))
        item = self.config_image_table.horizontalHeaderItem(0)
        item.setText(_translate("menu", "Placeholder"))
        item = self.config_image_table.horizontalHeaderItem(1)
        item.setText(_translate("menu", "Ảnh mẫu đối chiếu"))
        self.config_text_label.setText(_translate("menu", "<html><head/><body><p align=\"center\"><span style=\" font-weight:600;\">Text (Placeholder)</span></p></body></html>"))
        self.config_image_label.setText(_translate("menu", "<html><head/><body><p align=\"center\"><span style=\" font-weight:600;\">Hình ảnh</span></p></body></html>"))
        self.config_image_autodownload_label.setText(_translate("menu", "Ảnh hỗ trợ tự động download nếu là liên kết"))
        __sortingEnabled = self.config_text_list.isSortingEnabled()
        self.config_text_list.setSortingEnabled(False)
        item = self.config_text_list.item(0)
        item.setText(_translate("menu", "hoten"))
        item = self.config_text_list.item(1)
        item.setText(_translate("menu", "msv"))
        item = self.config_text_list.item(2)
        item.setText(_translate("menu", "nganh"))
        self.config_text_list.setSortingEnabled(__sortingEnabled)
        self.about.setText(_translate("menu", "<html><head/><body><p><img src=\":/main/about\"/></p></body></html>"))
        self.about.setToolTip("About")
        self.guide.setText(_translate("menu", "<html><head/><body><p><img src=\":/main/guide\"/></p></body></html>"))
        self.guide.setToolTip("Hướng dẫn sử dụng")
    def handleUI(self):
        self.config_text_add_button.clicked.connect(lambda: listEvent.add_item(self))
        self.config_text_remove_button.clicked.connect(lambda: listEvent.remove_item(self))
        self.config_image_add_button.clicked.connect(lambda: tableEvent.add_item(self))
        self.config_image_remove_button.clicked.connect(lambda: tableEvent.remove_item(self))
        self.template_broswe.clicked.connect(lambda: brosweEvent.template_powerpoint_broswe(self.centralwidget, self.template_path))
        self.dssv_broswe.clicked.connect(lambda: brosweEvent.dssv_broswe(self.centralwidget, self.dssv_path))
        self.VTLuu_broswe.clicked.connect(lambda: brosweEvent.save_broswe(self.centralwidget, self.VTLuu_path))
        # self.start_button.clicked.connect(lambda: process.Start())
        self.start_button.clicked.connect(lambda: self.showProgress())

    def showProgress(self):
        # Show progress here so it won't be destroyed
        if self.progress is None:
            self.progress = progress.Ui()
        self.progress.show()
